<?xml version='1.0' encoding='UTF-8'?>
<scenario>
  <id>scanner_scenario_shipping</id>
  <model_id>stock.picking</model_id>
  <name>Shipping</name>
  <sequence>120</sequence>
  <parent_id>stock_scanner.scanner_scenario_stock</parent_id>
  <active>True</active>
  <type>scenario</type>
  <Step id="scanner_scenario_step_shipping_done" name="Done" no_back="False" step_back="False" step_start="False" step_stop="True"/>
  <Step id="scanner_scenario_step_shipping_aborted" name="Aborted" no_back="False" step_back="False" step_start="False" step_stop="True"/>
  <Step id="scanner_scenario_step_shipping_invalid_product" name="Invalid Product" no_back="False" step_back="False" step_start="False" step_stop="False"/>
  <Step id="scanner_scenario_step_shipping_invalid_quantity" name="Invalid Quantity" no_back="False" step_back="False" step_start="False" step_stop="False"/>
  <Step id="scanner_scenario_step_shipping_location_selection" name="Location Selection" no_back="False" step_back="True" step_start="False" step_stop="False"/>
  <Step id="scanner_scenario_step_shipping_picking_selection" name="Picking Selection" no_back="True" step_back="True" step_start="True" step_stop="False"/>
  <Step id="scanner_scenario_step_shipping_picking_summary" name="Picking Summary" no_back="False" step_back="False" step_start="False" step_stop="False"/>
  <Step id="scanner_scenario_step_shipping_product_selection" name="Product Selection" no_back="True" step_back="True" step_start="False" step_stop="False"/>
  <Step id="scanner_scenario_step_shipping_quantity_selection" name="Quantity Selection" no_back="False" step_back="True" step_start="False" step_stop="False"/>
  <Step id="scanner_scenario_step_shipping_unknown_location" name="Unknown Location" no_back="False" step_back="False" step_start="False" step_stop="False"/>
  <Step id="scanner_scenario_step_shipping_unknown_picking" name="Unknown Picking" no_back="False" step_back="False" step_start="False" step_stop="False"/>
  <Transition condition="True" from_id="scanner_scenario_step_shipping_location_selection" id="scanner_scenario_shipping_location_selection_nok" name="Location Selection NOK" sequence="10" to_id="scanner_scenario_step_shipping_unknown_location" tracer="" transition_type="keyboard"/>
  <Transition condition="env['stock.move'].browse(int(terminal.tmp_val1)).location_id.name == message" from_id="scanner_scenario_step_shipping_location_selection" id="scanner_scenario_shipping_location_selection_ok" name="Location Selection OK" sequence="5" to_id="scanner_scenario_step_shipping_product_selection" tracer="" transition_type="keyboard"/>
  <Transition condition="True" from_id="scanner_scenario_step_shipping_picking_selection" id="scanner_scenario_shipping_picking_selection_nok" name="Picking Selection NOK" sequence="10" to_id="scanner_scenario_step_shipping_unknown_picking" tracer="" transition_type="keyboard"/>
  <Transition condition="model.search([('name', '=', message), ('picking_type_id.code', '=', 'outgoing'), ('state', '=', 'assigned')])" from_id="scanner_scenario_step_shipping_picking_selection" id="scanner_scenario_shipping_picking_selection_ok" name="Picking Selection OK" sequence="5" to_id="scanner_scenario_step_shipping_picking_summary" tracer="" transition_type="keyboard"/>
  <Transition condition="env['stock.picking.wave'].search([('name', '=', message), ('picking_ids.picking_type_id.code', '=', 'outgoing'), ('state', '=', 'in_progress')])" from_id="scanner_scenario_step_shipping_picking_selection" id="scanner_scenario_shipping_picking_wave_selection_ok" name="Picking Wave Selection OK" sequence="6" to_id="scanner_scenario_step_shipping_picking_summary" tracer="wave" transition_type="keyboard"/>
  <Transition condition="message == 'BACK'" from_id="scanner_scenario_step_shipping_picking_selection" id="scanner_scenario_shipping_picking_selection_aborted" name="Picking Selection Aborted" sequence="0" to_id="scanner_scenario_step_shipping_aborted" tracer="" transition_type="keyboard"/>
  <Transition condition="True" from_id="scanner_scenario_step_shipping_picking_summary" id="scanner_scenario_shipping_picking_summary_ok" name="Picking Summary OK" sequence="0" to_id="scanner_scenario_step_shipping_location_selection" tracer="" transition_type="keyboard"/>
  <Transition condition="True" from_id="scanner_scenario_step_shipping_product_selection" id="scanner_scenario_shipping_product_selection_nok" name="Product Selection NOK" sequence="20" to_id="scanner_scenario_step_shipping_invalid_product" tracer="" transition_type="keyboard"/>
  <Transition condition="message in (env['stock.move'].browse(int(terminal.tmp_val1)).product_id.default_code, env['stock.move'].browse(int(terminal.tmp_val1)).product_id.barcode)" from_id="scanner_scenario_step_shipping_product_selection" id="scanner_scenario_shipping_product_selection_ok" name="Product Selection OK" sequence="10" to_id="scanner_scenario_step_shipping_quantity_selection" tracer="" transition_type="keyboard"/>
  <Transition condition="True" from_id="scanner_scenario_step_shipping_quantity_selection" id="scanner_scenario_shipping_quantity_selection_nok" name="Quantity Selection NOK" sequence="10" to_id="scanner_scenario_step_shipping_invalid_quantity" tracer="" transition_type="keyboard"/>
  <Transition condition="0 &lt;= message &lt;= env['stock.move'].browse(int(terminal.tmp_val1)).product_qty" from_id="scanner_scenario_step_shipping_quantity_selection" id="scanner_scenario_shipping_quantity_selection_ok" name="Quantity Selection OK" sequence="0" to_id="scanner_scenario_step_shipping_location_selection" tracer="loop" transition_type="keyboard"/>
  <Transition condition="not env[terminal.tmp_val5].browse(terminal.reference_document).move_lines.filtered(lambda record: not record.linked_move_operation_ids)" from_id="scanner_scenario_step_shipping_location_selection" id="scanner_scenario_shipping_shipping_finished" name="Shipping Finished" sequence="0" to_id="scanner_scenario_step_shipping_done" tracer="" transition_type="keyboard"/>
</scenario>
